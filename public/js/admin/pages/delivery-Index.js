(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{299:function(t,e,n){"use strict";n.r(e);var r=n(0),o=n.n(r),a=n(6),i=n(5),s=n(7);function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p(t);if(e){var o=p(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return f(this,n)}}function f(t,e){return!e||"object"!==c(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(a,t);var e,n,r,o=d(a);function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=o.call(this,t)).indexUrl=i.n,e.namePlural="deliveries",e.nameLowerCase="delivery",e}return e=a,(n=[{key:"getLocationData",value:function(t){return s.a.get(this.indexUrl+"/locate/"+t)}}])&&l(e.prototype,n),r&&l(e,r),a}(a.a),m=n(4),b=n(10);function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function _(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h(t,e,n,r,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}var g={name:"DeliveryIndex",mixins:[m.b,m.a],data:function(){return{columns:["#","Ordered By","Rider","Vendor","From/To","Status","isCancelled","Delivered At","Created On"],rows:{data:[],links:{},meta:{}},model:new v}},methods:{formatDate:function(t){return moment(t).format("LLLL")},formatBookedDate:function(t){return moment(t).format("LL")},locationRider:function(t){var e,n=this;return(e=o.a.mark((function e(){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.driver){e.next=7;break}return e.next=3,n.model.getLocationData(t.driver.id);case 3:r=e.sent,n.getLocation(r.lat,r.long),e.next=8;break;case 7:n.getLocation(t.fromLat,t.fromLong);case 8:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(t){h(a,r,o,i,s,"next",t)}function s(t){h(a,r,o,i,s,"throw",t)}i(void 0)}))})()},getLocation:function(t,e){var n="https://api.opencagedata.com/geocode/v1/json?key=27ddafe76ecf4e9994bb61acf05e0243&q="+encodeURIComponent(t+","+e)+"&pretty=1&no_annotations=1";return fetch(n).then((function(t){return t.json()})).then((function(t){var e=t.results[0].components.suburb,n=t.results[0].components.neighbourhood,r=t.results[0].components.road,o=t.results[0].components.city,a="";r&&(a+=r+", "),e&&(a+=e+", "),n&&(a+="Near to "+n+", "),o&&(a+=o),swal("They are in",a)})).catch((function(){console.log("error")}))},fullAddress:function(t,e){swal("Full Address",t+" to "+e)}},mounted:function(){this.getModels()},created:function(){},watch:{},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){_(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(b.mapGetters)(["authUser"]))},w=(n(568),n(1)),O=Object(w.a)(g,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("app-card",{attrs:{title:"All <b>onGoing Deliveries</b>","body-padding":"0"}},[n("app-table-sortable",{attrs:{columns:t.columns,paginate:!0,rows:t.rows,searchUrl:"/admin/delivery/get-data?name="},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[n("td",{attrs:{title:"Order no"}},[t._v("\n        "+t._s(r.orderNo)+"\n      ")]),t._v(" "),n("td",[n("small",[t._v(t._s(r.order.orderBy)+" "),n("br"),t._v(" "),n("small",{staticClass:"badge"},[t._v("("+t._s(r.order.phone)+")")])])]),t._v(" "),n("td",[r.driver?n("small",{attrs:{title:r.driver.countryCode+" "+r.driver.phone}},[t._v("\n          "+t._s(r.driver.firstName)+" "+t._s(r.driver.lastName)+" "),n("br"),t._v(" "),n("small",{staticClass:"badge"},[t._v("("+t._s(r.driver.phone)+")")])]):n("small",[t._v("-")])]),t._v(" "),n("td",{attrs:{title:r.order.vendor.email}},[n("small",[t._v(t._s(r.order.vendor.businessName)+"\n          "),n("br"),t._v(" "),n("small",{staticClass:"badge"},[t._v("( "+t._s(r.order.vendor.phone)+")")])])]),t._v(" "),n("td",{on:{click:function(e){return t.fullAddress(r.from,r.to)}}},[t._v("\n        "+t._s(r.from.substring(0,40))+" ... / "+t._s(r.to.substring(0,40))+"...\n      ")]),t._v(" "),n("td",[n("small",{staticClass:"badge"},[t._v(t._s(r.status))])]),t._v(" "),n("td",[t._v("\n        "+t._s(r.logs?r.logs+" | By:"+r.cancelledBy:"NO")+"\n      ")]),t._v(" "),n("td",[n("small",[t._v(t._s(r.deliveredAt?t.formatBookedDate(r.deliveredAt):"-"))])]),t._v(" "),n("td",[n("small",[t._v(t._s(t.formatDate(r.createdAt)))])]),t._v(" "),"admin"===t.authUser.type||"superadmin"===t.authUser.type?n("td",{attrs:{width:"100"}},[n("div",{staticClass:"col-md-6"},[n("app-actions",{attrs:{actions:{delete:r.id}},on:{deleteItem:t.deleteModel}})],1),t._v(" "),"sunbi.mac@gmail.com"===t.authUser.email?n("div",{staticClass:"col-md-6"},[n("button",{staticClass:"btn btn-success btn-ajax",attrs:{type:"button",title:"Locate Them"},on:{click:function(e){return t.locationRider(r)}}},[n("i",{staticClass:"material-icons"},[t._v("location_searching")])])]):t._e()]):n("td")]}}])})],1)}),[],!1,null,"bd911382",null);e.default=O.exports},513:function(t,e,n){var r=n(569);"string"==typeof r&&(r=[[t.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(9)(r,o);r.locals&&(t.exports=r.locals)},568:function(t,e,n){"use strict";var r=n(513);n.n(r).a},569:function(t,e,n){(t.exports=n(8)(!1)).push([t.i,"\n.card-title[data-v-bd911382] {\n  padding: 10px 15px;\n  margin: 0;\n  font-weight: 400;\n  /* background-color : #337AB7; */\n  color: #666666;\n}\n",""])}}]);