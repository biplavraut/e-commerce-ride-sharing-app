(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{298:function(t,e,a){"use strict";a.r(e);var s=a(0),n=a.n(s),r=a(6),i=a(5),o=a(7);function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){for(var a=0;a<e.length;a++){var s=e[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,s=m(t);if(e){var n=m(this).constructor;a=Reflect.construct(s,arguments,n)}else a=s.apply(this,arguments);return p(this,a)}}function p(t,e){return!e||"object"!==c(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var _=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(r,t);var e,a,s,n=u(r);function r(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(e=n.call(this,t)).indexUrl=i.ib,e.namePlural="trips",e.nameLowerCase="trip",e}return e=r,(a=[{key:"getLocationData",value:function(t){return o.a.get(this.indexUrl+"/locate/"+t)}},{key:"getData",value:function(){return o.a.get(this.indexUrl)}},{key:"getAccident",value:function(){return o.a.get(this.indexUrl+"/get-accident-trips")}},{key:"getDispute",value:function(){return o.a.get(this.indexUrl+"/get-dispute-trips")}}])&&l(e.prototype,a),s&&l(e,s),r}(r.a),f=a(4),v=a(10);function h(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function g(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function b(t,e,a,s,n,r,i){try{var o=t[r](i),c=o.value}catch(t){return void a(t)}o.done?e(c):Promise.resolve(c).then(s,n)}var y={name:"TripIndex",mixins:[f.b,f.a],data:function(){return{columns:["tripId","User","Rider","From/To","Status","Payment","Distance/Duration","isCancelled","Created On","Completed At"],disputeCols:["tripId","User","Rider","From/To","Dispute Explain","By","Created On"],schColumns:["tripId","User","Rider","From/To","Status","Payment","Distance/Duration","isCancelled","Completed At","Schedule For"],title:"onGoing Trips",accCols:["tripId","User","Rider","From/To","Created On"],rows:{data:[],links:{},meta:{}},model:new _,accident:!1,dispute:!1,schedule:!1,paused:!1,completed:!1,state:"all",counts:{ongoing:0,accident:0,dispute:0,schedule:0,pause:0,completed:0},keyword:""}},methods:{formatDate:function(t){return moment(t).format("LLLL")},formatBookedDate:function(t){return moment(t).format("LLLL")},suspecious:function(t,e,a){var s=new Date(t),n=new Date(e),r=(s.getTime()-n.getTime())/1e3,i=this.parseTime(a).split(":"),o=60*+i[0]*60+60*+i[1]+ +i[2];return r<.5*o&&"Suspecious by "+this.time(.5*o-r)},delayed:function(t,e,a){var s=new Date(t),n=new Date(e),r=(s.getTime()-n.getTime())/1e3,i=this.parseTime(a).split(":"),o=60*+i[0]*60+60*+i[1]+ +i[2];return r>1.5*o&&"Delayed by "+this.time(r-.5*o)},time:function(t){var e=t/60;if(e<60)return Math.round(e)+" mins";if(e/60<24){var a=e/60,s=Math.floor(a),n=60*(a-s),r=Math.round(n);return s+" hours & "+Math.round(r)+" mins"}},parseTime:function(t){return t.match(/hours/)?t.replace(/hours|mins/gi,":").replace(/\s/g,"")+"0":"0:"+t.replace(/mins/,":").replace(/\s/g,"")+"0"},locationRider:function(t){var e,a=this;return(e=n.a.mark((function e(){var s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.rider){e.next=7;break}return e.next=3,a.model.getLocationData(t.rider.id);case 3:s=e.sent,a.getLocation(s.lat,s.long),e.next=8;break;case 7:a.getLocation(t.fromLat,t.fromLong);case 8:case"end":return e.stop()}}),e)})),function(){var t=this,a=arguments;return new Promise((function(s,n){var r=e.apply(t,a);function i(t){b(r,s,n,i,o,"next",t)}function o(t){b(r,s,n,i,o,"throw",t)}i(void 0)}))})()},getLocation:function(t,e){var a="https://api.opencagedata.com/geocode/v1/json?key=27ddafe76ecf4e9994bb61acf05e0243&q="+encodeURIComponent(t+","+e)+"&pretty=1&no_annotations=1";return fetch(a).then((function(t){return t.json()})).then((function(t){var e=t.results[0].components.suburb,a=t.results[0].components.neighbourhood,s=t.results[0].components.road,n=t.results[0].components.city,r="";s&&(r+=s+", "),e&&(r+=e+", "),a&&(r+="Near to "+a+", "),n&&(r+=n),swal("They are in",r)})).catch((function(){console.log("error")}))},fullAddress:function(t,e){swal("Full Address","From:\n"+t+"\nTo:\n"+e)},accidental:function(){var t=this;this.state="accident",this.accident=!0,this.dispute=!1,this.paused=!1,this.schedule=!1,this.completed=!1,this.title="Accident Trips",axios.get("/admin/trip/get-accident-trips").then((function(e){t.rows={data:[],links:{},meta:{}},t.rows.data=e.data.data,t.rows.links=e.data.links,t.rows.meta=e.data.meta}))},disputed:function(){var t=this;this.state="dispute",this.dispute=!0,this.accident=!1,this.schedule=!1,this.paused=!1,this.completed=!1,this.title="Disputed Trips",axios.get("/admin/trip/get-dispute-trips").then((function(e){t.rows={data:[],links:{},meta:{}},t.rows.data=e.data.data,t.rows.links=e.data.links,t.rows.meta=e.data.meta}))},pause:function(){var t=this;this.state="pause",this.dispute=!1,this.accident=!1,this.schedule=!1,this.paused=!0,this.completed=!1,this.title="Paused Trips",axios.get("/admin/trip/get-paused-trips").then((function(e){t.rows={data:[],links:{},meta:{}},t.rows.data=e.data.data,t.rows.links=e.data.links,t.rows.meta=e.data.meta}))},scheduled:function(){var t=this;this.state="schedule",this.accident=!1,this.dispute=!1,this.schedule=!0,this.paused=!1,this.completed=!1,this.title="Scheduled Trips",axios.get("/admin/trip/get-schedule-trips").then((function(e){t.rows={data:[],links:{},meta:{}},t.rows.data=e.data.data,t.rows.links=e.data.links,t.rows.meta=e.data.meta}))},completedTrip:function(){var t=this;this.state="completed",this.accident=!1,this.dispute=!1,this.schedule=!1,this.paused=!1,this.completed=!0,this.title="Completed Trips",axios.get("/admin/trip/get-completed-trips").then((function(e){t.rows={data:[],links:{},meta:{}},t.rows.data=e.data.data,t.rows.links=e.data.links,t.rows.meta=e.data.meta}))},reset:function(){var t=this;this.state="all",this.dispute=!1,this.accident=!1,this.schedule=!1,this.paused=!1,this.completed=!1,this.title="onGoing Trips",axios.get("/admin/trip").then((function(e){t.rows={data:[],links:{},meta:{}},t.rows.data=e.data.data,t.rows.links=e.data.links,t.rows.meta=e.data.meta}))},solveCase:function(t){var e=this;axios.get("/admin/trip/solve-case/"+t).then((function(t){"success"===t.data&&e.reset()}))},counter:function(){var t=this;axios.get("/admin/trip").then((function(e){t.counts.ongoing=e.data.meta.total})),axios.get("/admin/trip/get-accident-trips").then((function(e){t.counts.accident=e.data.meta.total})),axios.get("/admin/trip/get-dispute-trips").then((function(e){t.counts.dispute=e.data.meta.total})),axios.get("/admin/trip/get-schedule-trips").then((function(e){t.counts.schedule=e.data.meta.total})),axios.get("/admin/trip/get-completed-trips").then((function(e){t.counts.completed=e.data.meta.total})),axios.get("/admin/trip/get-paused-trips").then((function(e){t.counts.pause=e.data.meta.total}))}},mounted:function(){this.getModels(),this.counter()},created:function(){"accident"==this.$route.params.state&&this.accidental(),this.$route.params.word&&(this.keyword=this.$route.params.word)},watch:{},computed:function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?h(Object(a),!0).forEach((function(e){g(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}({},Object(v.mapGetters)(["authUser"]))},w=(a(566),a(1)),C=Object(w.a)(y,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("app-card",{attrs:{title:"All <b>"+t.title+"</b>","body-padding":"0"}},[a("ul",{staticClass:"nav nav-pills nav-pills-warning",staticStyle:{padding:"5px"}},[a("li",{class:"all"===t.state?"active":"",on:{click:function(e){return e.preventDefault(),t.reset(e)}}},[a("a",{attrs:{href:"#all","data-toggle":"tab","aria-expanded":"true"}},[t._v("onGoing\n        "),a("sup",[t.counts.ongoing>0?a("span",{staticClass:"badge"},[t._v(t._s(t.counts.ongoing))]):t._e()])])]),t._v(" "),a("li",{class:"schedule"===t.state?"active":"",on:{click:function(e){return e.preventDefault(),t.scheduled(e)}}},[a("a",{attrs:{href:"#schedule","data-toggle":"tab","aria-expanded":"true"}},[t._v("Scheduled\n        "),a("sup",[t.counts.schedule>0?a("span",{staticClass:"badge"},[t._v(t._s(t.counts.schedule))]):t._e()])])]),t._v(" "),a("li",{class:"accident"===t.state?"active":"",on:{click:function(e){return e.preventDefault(),t.accidental(e)}}},[a("a",{attrs:{href:"#accident","data-toggle":"tab","aria-expanded":"true"}},[t._v("Accident\n        "),a("sup",[t.counts.accident>0?a("span",{staticClass:"badge"},[t._v(t._s(t.counts.accident))]):t._e()])])]),t._v(" "),a("li",{class:"dispute"===t.state?"active":"",on:{click:function(e){return e.preventDefault(),t.disputed(e)}}},[a("a",{attrs:{href:"#dispute","data-toggle":"tab","aria-expanded":"true"}},[t._v("Disputed\n        "),a("sup",[t.counts.dispute>0?a("span",{staticClass:"badge"},[t._v(t._s(t.counts.dispute))]):t._e()])])]),t._v(" "),a("li",{class:"pause"===t.state?"active":"",on:{click:function(e){return e.preventDefault(),t.pause(e)}}},[a("a",{attrs:{href:"#paused","data-toggle":"tab","aria-expanded":"true"}},[t._v("Paused\n        "),a("sup",[t.counts.pause>0?a("span",{staticClass:"badge"},[t._v(t._s(t.counts.pause))]):t._e()])])]),t._v(" "),a("li",{class:"completed"===t.state?"active":"",on:{click:function(e){return e.preventDefault(),t.completedTrip(e)}}},[a("a",{attrs:{href:"#complete","data-toggle":"tab","aria-expanded":"true"}},[t._v("Completed\n        "),a("sup",[t.counts.completed>0?a("span",{staticClass:"badge"},[t._v(t._s(t.counts.completed))]):t._e()])])])]),t._v(" "),t.accident||t.dispute||t.schedule?t._e():a("app-table-sortable",{attrs:{columns:t.columns,paginate:!0,rows:t.rows,searchUrl:"/admin/trip/get-data?name=",word:t.keyword},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[a("td",[t._v(t._s(s.tripId))]),t._v(" "),a("td",{attrs:{title:s.user.countryCode+" "+s.user.phone}},[a("small",[t._v(t._s(s.user.firstName)+" "+t._s(s.user.lastName)+"\n          "),a("small",[t._v("("+t._s(s.user.phone)+")")])])]),t._v(" "),a("td",[s.rider?a("small",{attrs:{title:s.rider.country_code+" "+s.rider.phone}},[t._v("\n          "+t._s(s.rider.name)+"\n          "),a("small",[t._v("("+t._s(s.rider.phone)+")")])]):a("small",[t._v("-")])]),t._v(" "),a("td",{on:{click:function(e){return t.fullAddress(s.from,s.to)}}},[t._v("\n        "+t._s(s.from.substring(0,20))+" ... / "+t._s(s.to.substring(0,20))+"...\n      ")]),t._v(" "),a("td",[a("small",{staticClass:"badge"},[t._v(t._s(s.status))]),t._v(" "),"completed"==s.status?a("span",[t.suspecious(s.completedAt,s.createdAt,s.duration)?a("small",{staticClass:"badge bg-danger"},[t._v(t._s(t.suspecious(s.completedAt,s.createdAt,s.duration)))]):t._e(),t._v(" "),t.delayed(s.completedAt,s.createdAt,s.duration)?a("small",{staticClass:"badge bg-warning"},[t._v(t._s(t.delayed(s.completedAt,s.createdAt,s.duration)))]):t._e()]):t._e()]),t._v(" "),a("td",[t._v("\n        "+t._s(s.paymentMode)+"\n        "),a("small",{staticClass:"badge",attrs:{title:"Charge(NRs.)"}},[t._v(t._s(s.charge))])]),t._v(" "),a("td",[t._v(t._s(s.distance)+" / "+t._s(s.duration))]),t._v(" "),a("td",[t._v("\n        "+t._s(s.log?s.log+" | By:"+s.cancelledBy:"NO")+"\n      ")]),t._v(" "),a("td",[a("small",[t._v(t._s(t.formatDate(s.createdAt)))])]),t._v(" "),a("td",[a("small",[t._v(t._s(s.completedAt?t.formatBookedDate(s.completedAt):"-"))])]),t._v(" "),a("td",[a("div",{staticClass:"row"},["completed"!=s.status?a("div",{staticClass:"col-md-6"},[a("app-actions",{attrs:{actions:{delete:s.id},title:"Cancel"},on:{deleteItem:t.deleteModel}})],1):t._e(),t._v(" "),"biplavraut@gmail.com"===t.authUser.email?a("div",{staticClass:"col-md-6"},[a("button",{staticClass:"btn btn-success btn-ajax",attrs:{type:"button",title:"Locate Them"},on:{click:function(e){return t.locationRider(s)}}},[a("i",{staticClass:"material-icons"},[t._v("location_searching")])])]):t._e()])])]}}],null,!1,3607087033)}),t._v(" "),t.schedule?a("app-table-sortable",{attrs:{columns:t.schColumns,paginate:!0,rows:t.rows,searchUrl:"/admin/trip/get-data?name=",word:t.keyword},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[a("td",[t._v(t._s(s.tripId))]),t._v(" "),a("td",{attrs:{title:s.user.countryCode+" "+s.user.phone}},[a("small",[t._v(t._s(s.user.firstName)+" "+t._s(s.user.lastName)+"\n          "),a("small",[t._v("("+t._s(s.user.phone)+")")])])]),t._v(" "),a("td",[s.rider?a("small",{attrs:{title:s.rider.country_code+" "+s.rider.phone}},[t._v("\n          "+t._s(s.rider.name)+"\n          "),a("small",[t._v("("+t._s(s.rider.phone)+")")])]):a("small",[t._v("-")])]),t._v(" "),a("td",{on:{click:function(e){return t.fullAddress(s.from,s.to)}}},[t._v("\n        "+t._s(s.from.substring(0,20))+" ... / "+t._s(s.to.substring(0,20))+"...\n      ")]),t._v(" "),a("td",[a("small",{staticClass:"badge"},[t._v(t._s(s.status))])]),t._v(" "),a("td",[t._v("\n        "+t._s(s.paymentMode)+"\n        "),a("small",{staticClass:"badge",attrs:{title:"Charge(NRs.)"}},[t._v(t._s(s.charge))])]),t._v(" "),a("td",[t._v(t._s(s.distance)+" / "+t._s(s.duration))]),t._v(" "),a("td",[t._v("\n        "+t._s(s.log?s.log+" | By:"+s.cancelledBy:"NO")+"\n      ")]),t._v(" "),a("td",[a("small",[t._v(t._s(s.completedAt?t.formatBookedDate(s.completedAt):"-"))])]),t._v(" "),a("td",[s.schedule?a("small",[t._v("\n          "+t._s(t.formatDate(s.schedule.date+" "+s.schedule.time)))]):t._e()]),t._v(" "),a("td",{attrs:{width:"0"}},[a("div",{staticClass:"col-md-6"},[a("app-actions",{attrs:{actions:{delete:s.id}},on:{deleteItem:t.deleteModel}})],1),t._v(" "),"sunbi.mac@gmail.com"===t.authUser.email?a("div",{staticClass:"col-md-6"},[a("button",{staticClass:"btn btn-success btn-ajax",attrs:{type:"button",title:"Locate Them"},on:{click:function(e){return t.locationRider(s)}}},[a("i",{staticClass:"material-icons"},[t._v("location_searching")])])]):t._e()])]}}],null,!1,1715439362)}):t._e(),t._v(" "),t.dispute?a("app-table-sortable",{attrs:{columns:t.disputeCols,paginate:!0,rows:t.rows,searchUrl:"/admin/trip/get-data?name="},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[a("td",[t._v(t._s(s.tripId))]),t._v(" "),a("td",{attrs:{title:s.user.countryCode+" "+s.user.phone}},[a("small",[t._v(t._s(s.user.firstName)+" "+t._s(s.user.lastName)+"\n          "),a("small",[t._v("("+t._s(s.user.phone)+")")])])]),t._v(" "),a("td",[s.rider?a("small",{attrs:{title:s.rider.country_code+" "+s.rider.phone}},[t._v("\n          "+t._s(s.rider.name)+"\n          "),a("small",[t._v("("+t._s(s.rider.phone)+")")])]):a("small",[t._v("-")])]),t._v(" "),a("td",{on:{click:function(e){return t.fullAddress(s.from,s.to)}}},[t._v("\n        "+t._s(s.from.substring(0,40))+" ... / "+t._s(s.to.substring(0,40))+"...\n      ")]),t._v(" "),a("td",[t._v("\n        "+t._s(s.dispute)+"\n      ")]),t._v(" "),a("td",[t._v(t._s(s.cancelledBy))]),t._v(" "),a("td",[a("small",[t._v(t._s(t.formatDate(s.createdAt)))])]),t._v(" "),a("td",{attrs:{width:"0"}},[a("div",{staticClass:"col-md-6"},[a("button",{staticClass:"btn btn-success btn-ajax",attrs:{type:"button",title:"Mark as Solved"},on:{click:function(e){return t.solveCase(s.id)}}},[a("i",{staticClass:"material-icons"},[t._v("done")])])]),t._v(" "),a("div",{staticClass:"col-md-6"},[a("app-actions",{attrs:{actions:{delete:s.id}},on:{deleteItem:t.deleteModel}})],1),t._v(" "),"sunbi.mac@gmail.com"===t.authUser.email?a("div",{staticClass:"col-md-6"},[a("button",{staticClass:"btn btn-success btn-ajax",attrs:{type:"button",title:"Locate Them"},on:{click:function(e){return t.locationRider(s)}}},[a("i",{staticClass:"material-icons"},[t._v("location_searching")])])]):t._e()])]}}],null,!1,1495572081)}):t._e(),t._v(" "),t.accident?a("app-table-sortable",{attrs:{columns:t.accCols,paginate:!0,rows:t.rows,searchUrl:"/admin/trip/get-data?name=",word:t.keyword},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[a("td",[t._v(t._s(s.tripId))]),t._v(" "),a("td",{attrs:{title:s.user.countryCode+" "+s.user.phone}},[a("small",[t._v(t._s(s.user.firstName)+" "+t._s(s.user.lastName)+"\n          "),a("small",[t._v("("+t._s(s.user.phone)+")")])])]),t._v(" "),a("td",[s.rider?a("small",{attrs:{title:s.rider.country_code+" "+s.rider.phone}},[t._v("\n          "+t._s(s.rider.name)+"\n          "),a("small",[t._v("("+t._s(s.rider.phone)+")")])]):a("small",[t._v("-")])]),t._v(" "),a("td",{on:{click:function(e){return t.fullAddress(s.from,s.to)}}},[t._v("\n        "+t._s(s.from.substring(0,40))+" ... / "+t._s(s.to.substring(0,40))+"...\n      ")]),t._v(" "),a("td",[a("small",[t._v(t._s(t.formatDate(s.createdAt)))])]),t._v(" "),a("td",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-4"},[a("button",{staticClass:"btn btn-success btn-ajax",attrs:{type:"button",title:"Mark as Solved"},on:{click:function(e){return t.solveCase(s.id)}}},[a("i",{staticClass:"material-icons"},[t._v("done")])])]),t._v(" "),a("div",{staticClass:"col-md-4"},[a("app-actions",{attrs:{actions:{delete:s.id}},on:{deleteItem:t.deleteModel}})],1),t._v(" "),"sunbi.mac@gmail.com"===t.authUser.email?a("div",{staticClass:"col-md-4"},[a("button",{staticClass:"btn btn-success btn-ajax",attrs:{type:"button",title:"Locate Them"},on:{click:function(e){return t.locationRider(s)}}},[a("i",{staticClass:"material-icons"},[t._v("location_searching")])])]):t._e()])])]}}],null,!1,3533766451)}):t._e()],1)}),[],!1,null,"224eb02c",null);e.default=C.exports},512:function(t,e,a){var s=a(567);"string"==typeof s&&(s=[[t.i,s,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};a(9)(s,n);s.locals&&(t.exports=s.locals)},566:function(t,e,a){"use strict";var s=a(512);a.n(s).a},567:function(t,e,a){(t.exports=a(8)(!1)).push([t.i,"\n.card-title[data-v-224eb02c] {\n  padding: 10px 15px;\n  margin: 0;\n  font-weight: 400;\n  /* background-color : #337AB7; */\n  color: #666666;\n}\n.bg-danger[data-v-224eb02c]{\n  background-color: #fa5661;\n}\n.bg-warning[data-v-224eb02c]{\n  background-color: #ff9800;\n}\n",""])}}]);